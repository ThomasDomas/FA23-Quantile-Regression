# install.packages("quantreg")
library("quantreg")
#library(sjPlot)
library(haven)
library(gridExtra)
library(tidyverse)
library(Metrics)
require(gridExtra)
#library(equatiomatic)
#library(fastDummies)
#library(pscl)
#library(gsheet)
#library(brant)
#library(MASS)
#library(lmtest)
#library(reshape2)
#library(nnet)
#library(AER)
#library(boot)
#library(asaur)
df <- read.csv("TrainData.csv") |>
na.omit() |>
distinct()
df |> ggplot(aes(y = SalePrice, x = LotArea)) +
geom_point(size = 0.9) +
geom_smooth(method = lm, se = F, color = "black") +
geom_text(aes(y = 400000, x = 150000, label = "OLS"), color="black") +
geom_quantile(quantiles=0.5, color="red") +
geom_text(aes(y = 470000, x = 90000, label = "50th quantile"), color="red") +
ylab("Sale price ($)") +
xlab("Lot area (Square feet)") +
theme_bw()
# df |> ggplot(aes(y = SalePrice, x = GrLivArea)) +
#   geom_boxplot()
df |> ggplot(aes(y = SalePrice, x = GrLivArea)) +
geom_point(size = 0.9) +
stat_smooth(method = lm, color = "black") +
geom_text(aes(x = 4150, y = 500000, label = "OLS"), color="black") +
geom_quantile(quantiles=0.25, color="red") +
geom_text(aes(x = 4000, y = 270000, label = "25th quantile"), color="red") +
geom_quantile(quantiles=0.5, color="blue") +
geom_text(aes(x = 4150, y = 400000, label = "50th"), color="blue") +
geom_quantile(quantiles=0.75, color="green") +
geom_text(aes(x = 4000, y = 600000, label = "75th quantile"), color="green") +
xlab("Sale price ($)") +
ylab("Above ground area (Square feet)") +
theme_bw()
qr50 = rq(data=df, SalePrice ~ GrLivArea + LotArea + TotRmsAbvGrd + as.factor(LotShape) + as.factor(Foundation), tau=0.5)
qr50_summary = summary(qr50)
qr50_summary
#| echo: false
#Generate all QR models
taus <- seq(from=0, to=1, by=.01)
qrs = rq(data=df, SalePrice ~ GrLivArea + LotArea + TotRmsAbvGrd + as.factor(LotShape) + as.factor(Foundation), tau=taus)
num_of_rows <- nrow(qrs$coefficients)
print(qrs$coefficients)
p_grLivArea <- plot(qrs$coefficients[2, ])
p_LotArea <- plot(qrs$coefficients[3, ])
p_TotsRmsAbvGrd <- plot(qrs$coefficients[4, ])
p_IR2 <- plot(qrs$coefficients[5, ])
p_IR3 <- plot(qrs$coefficients[6, ])
p_Reg <- plot(qrs$coefficients[7, ])
p_CBlock <- plot(qrs$coefficients[8, ])
p_Conic <- plot(qrs$coefficients[9, ])
grid.arrange(plot(qrs$coefficients[2, ]),
plot(qrs$coefficients[3, ]),
plot(qrs$coefficients[4, ]),
plot(qrs$coefficients[5, ]),
plot(qrs$coefficients[6, ]),
plot(qrs$coefficients[7, ]),
plot(qrs$coefficients[8, ]),
plot(qrs$coefficients[9, ]),
ncol=3)
ols = lm(data=df, SalePrice ~ GrLivArea + LotArea + TotRmsAbvGrd + as.factor(LotShape) + as.factor(Foundation))
ols_summary = summary(ols)
ols_summary
olsMae = mae(predict(ols), df$SalePrice)
olsMae
Qr50Mae = mae(predict(qr50), df$SalePrice)
Qr50Mae
olsRmse = rmse(predict(ols), df$SalePrice)
olsRmse
Qr50Rmse = rmse(predict(qr50), df$SalePrice)
Qr50Rmse
ols_summary$df[2]
qr50_summary$rdf
# Min OLS error
format(round(min(ols_summary$residuals), digits=0), scientific=F)
# Absolute min OLS error
format(round(min(abs(ols_summary$residuals)), digits=0), scientific=F)
# Max OLS error
format(round(max(ols_summary$residuals), digits=0), scientific=F)
# Absolute max OLS error
format(round(max(abs(ols_summary$residuals)), digits=0), scientific=F)
# Min QR 50th error
format(round(min(qr50_summary$residuals), digits=0), scientific=F)
# Absolute min QR 50th error
format(round(min(abs(qr50_summary$residuals)), digits=0), scientific=F)
# Max QR 50th error
format(round(max(qr50_summary$residuals), digits=0), scientific=F)
# Absolute max QR 50th error
format(round(max(abs(qr50_summary$residuals)), digits=0), scientific=F)
cowplot::plot_grid(plot(qrs$coefficients[2, ]),
plot(qrs$coefficients[3, ]),
plot(qrs$coefficients[4, ]),
plot(qrs$coefficients[5, ]),
plot(qrs$coefficients[6, ]),
plot(qrs$coefficients[7, ]),
plot(qrs$coefficients[8, ]),
plot(qrs$coefficients[9, ]))
num_of_rows <- nrow(qrs$coefficients)
par(mfrow=c(3,3))
plot(qrs$coefficients[1, ])
library(ggpubr)
library(cowplot)
ggplot(qrs$coefficients[2, ])
multiplot(plot(qrs$coefficients[2, ]),
plot(qrs$coefficients[3, ]),
plot(qrs$coefficients[4, ]),
plot(qrs$coefficients[5, ]),
plot(qrs$coefficients[6, ]),
plot(qrs$coefficients[7, ]),
plot(qrs$coefficients[8, ]),
plot(qrs$coefficients[9, ]))
library(ggplot2)
multiplot(plot(qrs$coefficients[2, ]),
plot(qrs$coefficients[3, ]),
plot(qrs$coefficients[4, ]),
plot(qrs$coefficients[5, ]),
plot(qrs$coefficients[6, ]),
plot(qrs$coefficients[7, ]),
plot(qrs$coefficients[8, ]),
plot(qrs$coefficients[9, ]))
ggplot2::multiplot(plot(qrs$coefficients[2, ]),
plot(qrs$coefficients[3, ]),
plot(qrs$coefficients[4, ]),
plot(qrs$coefficients[5, ]),
plot(qrs$coefficients[6, ]),
plot(qrs$coefficients[7, ]),
plot(qrs$coefficients[8, ]),
plot(qrs$coefficients[9, ]))
ggplot::multiplot(plot(qrs$coefficients[2, ]),
plot(qrs$coefficients[3, ]),
plot(qrs$coefficients[4, ]),
plot(qrs$coefficients[5, ]),
plot(qrs$coefficients[6, ]),
plot(qrs$coefficients[7, ]),
plot(qrs$coefficients[8, ]),
plot(qrs$coefficients[9, ]))
par(mfrow = c(7, 1))
plot(qrs$coefficients[2, ])
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(7, 1))
plot(qrs$coefficients[2, ])
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(1, 7))
plot(qrs$coefficients[2, ])
plot(qrs$coefficients[3, ])
plot(qrs$coefficients[4, ])
plot(qrs$coefficients[5, ])
plot(qrs$coefficients[6, ])
plot(qrs$coefficients[7, ])
plot(qrs$coefficients[8, ])
plot(qrs$coefficients[9, ])
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(7, 1))
plot(qrs$coefficients[2, ])
num_of_rows <- nrow(qrs$coefficients)
par(mfcol = c(1, 7))
plot(qrs$coefficients[2, ])
plot(qrs$coefficients[3, ])
plot(qrs$coefficients[4, ])
plot(qrs$coefficients[5, ])
plot(qrs$coefficients[6, ])
plot(qrs$coefficients[7, ])
plot(qrs$coefficients[8, ])
plot(qrs$coefficients[9, ])
par(mfcol = c(7, 1))
plot(qrs$coefficients[2, ])
num_of_rows <- nrow(qrs$coefficients)
par(mfcol = c(7, 1))
plot(qrs$coefficients[2, ])
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(1, 7))
plot(qrs$coefficients[2, ])
plot(qrs$coefficients[3, ])
plot(qrs$coefficients[4, ])
plot(qrs$coefficients[5, ])
plot(qrs$coefficients[6, ])
plot(qrs$coefficients[7, ])
plot(qrs$coefficients[8, ])
plot(qrs$coefficients[9, ])
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(2, 3))
plot(qrs$coefficients[1, ])
plot(qrs$coefficients[2, ])
plot(qrs$coefficients[3, ])
plot(qrs$coefficients[4, ])
plot(qrs$coefficients[5, ])
plot(qrs$coefficients[6, ])
plot(qrs$coefficients[7, ])
plot(qrs$coefficients[8, ])
plot(qrs$coefficients[9, ])
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(3, 3))
plot(qrs$coefficients[1, ])
plot(qrs$coefficients[2, ])
plot(qrs$coefficients[3, ])
plot(qrs$coefficients[4, ])
plot(qrs$coefficients[5, ])
plot(qrs$coefficients[6, ])
plot(qrs$coefficients[7, ])
plot(qrs$coefficients[8, ])
plot(qrs$coefficients[9, ])
par(mfrow = c(3, 3))
plot(qrs$coefficients[1, ], xlab="Quantiles")
plot(qrs$coefficients[2, ], xlab="Quantiles")
plot(qrs$coefficients[3, ], xlab="Quantiles")
plot(qrs$coefficients[4, ], xlab="Quantiles")
plot(qrs$coefficients[5, ], xlab="Quantiles")
plot(qrs$coefficients[6, ], xlab="Quantiles")
plot(qrs$coefficients[7, ], xlab="Quantiles")
plot(qrs$coefficients[8, ], xlab="Quantiles")
plot(qrs$coefficients[9, ], xlab="Quantiles")
print(qr$coefficients)
print(qrs$coefficients)
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(3, 3))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
plot(qrs$coefficients[2, ], xlab="Quantiles", ylab="Lot-Area")
plot(qrs$coefficients[3, ], xlab="Quantiles", ylab="TotRmsAbvGrd")
plot(qrs$coefficients[4, ], xlab="Quantiles", ylab="LotShape-IR2")
plot(qrs$coefficients[5, ], xlab="Quantiles", ylab="LotShape-IR3")
plot(qrs$coefficients[6, ], xlab="Quantiles", ylab="LotShape-Reg")
plot(qrs$coefficients[7, ], xlab="Quantiles", ylab="Foundation-CBlock")
plot(qrs$coefficients[8, ], xlab="Quantiles", ylab="Foundation-PConc")
plot(qrs$coefficients[9, ], xlab="Quantiles", ylab="Foundation-Slab")
plot(qrs$coefficients[10, ], xlab="Quantiles", ylab="Foundation-Stone")
plot(qrs$coefficients[11, ], xlab="Quantiles", ylab="Foundation-Wood")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(3, 4))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
plot(qrs$coefficients[2, ], xlab="Quantiles", ylab="Lot-Area")
plot(qrs$coefficients[3, ], xlab="Quantiles", ylab="TotRmsAbvGrd")
plot(qrs$coefficients[4, ], xlab="Quantiles", ylab="LotShape-IR2")
plot(qrs$coefficients[5, ], xlab="Quantiles", ylab="LotShape-IR3")
plot(qrs$coefficients[6, ], xlab="Quantiles", ylab="LotShape-Reg")
plot(qrs$coefficients[7, ], xlab="Quantiles", ylab="Foundation-CBlock")
plot(qrs$coefficients[8, ], xlab="Quantiles", ylab="Foundation-PConc")
plot(qrs$coefficients[9, ], xlab="Quantiles", ylab="Foundation-Slab")
plot(qrs$coefficients[10, ], xlab="Quantiles", ylab="Foundation-Stone")
plot(qrs$coefficients[11, ], xlab="Quantiles", ylab="Foundation-Wood")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(4, 3))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(4, 3))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(2, 5))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
plot(qrs$coefficients[2, ], xlab="Quantiles", ylab="Lot-Area")
plot(qrs$coefficients[3, ], xlab="Quantiles", ylab="TotRmsAbvGrd")
plot(qrs$coefficients[4, ], xlab="Quantiles", ylab="LotShape-IR2")
plot(qrs$coefficients[5, ], xlab="Quantiles", ylab="LotShape-IR3")
plot(qrs$coefficients[6, ], xlab="Quantiles", ylab="LotShape-Reg")
plot(qrs$coefficients[7, ], xlab="Quantiles", ylab="Foundation-CBlock")
plot(qrs$coefficients[8, ], xlab="Quantiles", ylab="Foundation-PConc")
plot(qrs$coefficients[9, ], xlab="Quantiles", ylab="Foundation-Slab")
plot(qrs$coefficients[10, ], xlab="Quantiles", ylab="Foundation-Stone")
plot(qrs$coefficients[11, ], xlab="Quantiles", ylab="Foundation-Wood")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(3, 5))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
plot(qrs$coefficients[2, ], xlab="Quantiles", ylab="Lot-Area")
plot(qrs$coefficients[3, ], xlab="Quantiles", ylab="TotRmsAbvGrd")
plot(qrs$coefficients[4, ], xlab="Quantiles", ylab="LotShape-IR2")
plot(qrs$coefficients[5, ], xlab="Quantiles", ylab="LotShape-IR3")
plot(qrs$coefficients[6, ], xlab="Quantiles", ylab="LotShape-Reg")
plot(qrs$coefficients[7, ], xlab="Quantiles", ylab="Foundation-CBlock")
plot(qrs$coefficients[8, ], xlab="Quantiles", ylab="Foundation-PConc")
plot(qrs$coefficients[9, ], xlab="Quantiles", ylab="Foundation-Slab")
plot(qrs$coefficients[10, ], xlab="Quantiles", ylab="Foundation-Stone")
plot(qrs$coefficients[11, ], xlab="Quantiles", ylab="Foundation-Wood")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(4, 4))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(5, 3))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(3, 5))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
plot(qrs$coefficients[2, ], xlab="Quantiles", ylab="Lot-Area")
plot(qrs$coefficients[3, ], xlab="Quantiles", ylab="TotRmsAbvGrd")
plot(qrs$coefficients[4, ], xlab="Quantiles", ylab="LotShape-IR2")
plot(qrs$coefficients[5, ], xlab="Quantiles", ylab="LotShape-IR3")
plot(qrs$coefficients[6, ], xlab="Quantiles", ylab="LotShape-Reg")
plot(qrs$coefficients[7, ], xlab="Quantiles", ylab="Foundation-CBlock")
plot(qrs$coefficients[8, ], xlab="Quantiles", ylab="Foundation-PConc")
plot(qrs$coefficients[9, ], xlab="Quantiles", ylab="Foundation-Slab")
plot(qrs$coefficients[10, ], xlab="Quantiles", ylab="Foundation-Stone")
plot(qrs$coefficients[11, ], xlab="Quantiles", ylab="Foundation-Wood")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(5, 4))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(4, 4))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(7, 2))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(7, 3))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(7, 7))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(3, 5))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
plot(qrs$coefficients[2, ], xlab="Quantiles", ylab="Lot-Area")
plot(qrs$coefficients[3, ], xlab="Quantiles", ylab="TotRmsAbvGrd")
plot(qrs$coefficients[4, ], xlab="Quantiles", ylab="LotShape-IR2")
plot(qrs$coefficients[5, ], xlab="Quantiles", ylab="LotShape-IR3")
plot(qrs$coefficients[6, ], xlab="Quantiles", ylab="LotShape-Reg")
plot(qrs$coefficients[7, ], xlab="Quantiles", ylab="Foundation-CBlock")
plot(qrs$coefficients[8, ], xlab="Quantiles", ylab="Foundation-PConc")
plot(qrs$coefficients[9, ], xlab="Quantiles", ylab="Foundation-Slab")
plot(qrs$coefficients[10, ], xlab="Quantiles", ylab="Foundation-Stone")
plot(qrs$coefficients[11, ], xlab="Quantiles", ylab="Foundation-Wood")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(4, 5))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(3, 3))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
plot(qrs$coefficients[2, ], xlab="Quantiles", ylab="Lot-Area")
plot(qrs$coefficients[3, ], xlab="Quantiles", ylab="TotRmsAbvGrd")
plot(qrs$coefficients[4, ], xlab="Quantiles", ylab="LotShape-IR2")
plot(qrs$coefficients[5, ], xlab="Quantiles", ylab="LotShape-IR3")
plot(qrs$coefficients[6, ], xlab="Quantiles", ylab="LotShape-Reg")
plot(qrs$coefficients[7, ], xlab="Quantiles", ylab="Foundation-CBlock")
plot(qrs$coefficients[8, ], xlab="Quantiles", ylab="Foundation-PConc")
plot(qrs$coefficients[9, ], xlab="Quantiles", ylab="Foundation-Slab")
plot(qrs$coefficients[10, ], xlab="Quantiles", ylab="Foundation-Stone")
plot(qrs$coefficients[11, ], xlab="Quantiles", ylab="Foundation-Wood")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(4, 3))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(3, 4))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
plot(qrs$coefficients[2, ], xlab="Quantiles", ylab="Lot-Area")
plot(qrs$coefficients[3, ], xlab="Quantiles", ylab="TotRmsAbvGrd")
plot(qrs$coefficients[4, ], xlab="Quantiles", ylab="LotShape-IR2")
plot(qrs$coefficients[5, ], xlab="Quantiles", ylab="LotShape-IR3")
plot(qrs$coefficients[6, ], xlab="Quantiles", ylab="LotShape-Reg")
plot(qrs$coefficients[7, ], xlab="Quantiles", ylab="Foundation-CBlock")
plot(qrs$coefficients[8, ], xlab="Quantiles", ylab="Foundation-PConc")
plot(qrs$coefficients[9, ], xlab="Quantiles", ylab="Foundation-Slab")
plot(qrs$coefficients[10, ], xlab="Quantiles", ylab="Foundation-Stone")
plot(qrs$coefficients[11, ], xlab="Quantiles", ylab="Foundation-Wood")
resize.win(5,5)
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(2, 2))
print(qrs$coefficients)
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
plot(qrs$coefficients[2, ], xlab="Quantiles", ylab="Lot-Area")
plot(qrs$coefficients[3, ], xlab="Quantiles", ylab="TotRmsAbvGrd")
plot(qrs$coefficients[4, ], xlab="Quantiles", ylab="LotShape-IR2")
plot(qrs$coefficients[5, ], xlab="Quantiles", ylab="LotShape-IR3")
plot(qrs$coefficients[6, ], xlab="Quantiles", ylab="LotShape-Reg")
plot(qrs$coefficients[7, ], xlab="Quantiles", ylab="Foundation-CBlock")
plot(qrs$coefficients[8, ], xlab="Quantiles", ylab="Foundation-PConc")
plot(qrs$coefficients[9, ], xlab="Quantiles", ylab="Foundation-Slab")
plot(qrs$coefficients[10, ], xlab="Quantiles", ylab="Foundation-Stone")
plot(qrs$coefficients[11, ], xlab="Quantiles", ylab="Foundation-Wood")
title("Betas of Each Variable Per Quantile")
num_of_rows <- nrow(qrs$coefficients)
par(mfrow = c(2, 2))
plot(qrs$coefficients[1, ], xlab="Quantiles", ylab="Y-Intercepts")
plot(qrs$coefficients[2, ], xlab="Quantiles", ylab="Lot-Area")
plot(qrs$coefficients[3, ], xlab="Quantiles", ylab="TotRmsAbvGrd")
plot(qrs$coefficients[4, ], xlab="Quantiles", ylab="LotShape-IR2")
plot(qrs$coefficients[5, ], xlab="Quantiles", ylab="LotShape-IR3")
plot(qrs$coefficients[6, ], xlab="Quantiles", ylab="LotShape-Reg")
plot(qrs$coefficients[7, ], xlab="Quantiles", ylab="Foundation-CBlock")
plot(qrs$coefficients[8, ], xlab="Quantiles", ylab="Foundation-PConc")
plot(qrs$coefficients[9, ], xlab="Quantiles", ylab="Foundation-Slab")
plot(qrs$coefficients[10, ], xlab="Quantiles", ylab="Foundation-Stone")
plot(qrs$coefficients[11, ], xlab="Quantiles", ylab="Foundation-Wood")
plot.new()
text(0.5,0.5,"First title",cex=2,font=2)
#install.packages("gsheet")
#install.packages("tidyverse")
library(gsheet)
library(tidyverse)
gss <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1QgTiSaxVkZvLs9guX-pnAxln0hn4Xtsa1DiRGjcKXsM/edit?usp=sharing") %>%
mutate(Ideology = as.factor(Ideology))
head(gss)
m2 <- MASS::polr(Ideology ~ Party + Sex + Party*Sex,
data = gss,
Hess = TRUE)
summary(m2)
f <- MASS::polr(Ideology ~ Party + Sex + Party*Sex, data = gss, Hess = TRUE)
r <- MASS::polr(Ideology ~ Party + Sex, data = gss,Hess = TRUE)
anova(r, f, test = "Chisq")
m2 <- MASS::polr(Ideology ~ Party + Sex + Party*Sex,
data = gss,
Hess = TRUE)
summary(m2)
#install.packages("brant")
library(brant)
brant(m2)
library(nnet)
m7 <- multinom(Ideology ~ Party + Sex + Party*Sex,
data = gss)
summary(m7)
full <- multinom(Ideology ~ Party + Sex + Party*Sex, data = gss)
reduced <- multinom(Ideology ~ Party + Sex, data = gss)
anova(reduced, full, test = "Chisq")
full <- multinom(Ideology ~ Party + Sex , data = gss)
reduced <- multinom(Ideology ~ Sex, data = gss)
anova(reduced, full, test = "Chisq")
z <- summary(m7)$coefficients/summary(m7)$standard.errors # construct z
p <- (1 - pnorm(abs(z)))*2 # construct p-values
t(p) # transpose to columns
anova(reduced, full, test="F")
full <- glm(body_mass_kg ~ flipper_length_mm + bill_length_mm, data=df, family="gaussian")
#install.packages("palmerpenguins")
library(tinytex)
library(palmerpenguins)
#install.packages("dplyr")
library(dplyr)
#install.packages("ggplot2")
library(ggplot2)
#install.packages("emmeans")
library(emmeans)
data(package = 'palmerpenguins')
df <- penguins
df %>% summarize(mean = mean(body_mass_g, na.rm=TRUE), sd=sd(body_mass_g, na.rm=TRUE))
df %>% group_by(species) %>% summarize(mean = mean(body_mass_g, na.rm=TRUE), sd=sd(body_mass_g, na.rm=TRUE))
df_grouped <- df %>% group_by(species) %>% summarize(mean = mean(body_mass_g, na.rm=TRUE), sd=sd(body_mass_g, na.rm=TRUE),     lci = t.test(body_mass_g, conf.level = 0.95)$conf.int[1], uci = t.test(body_mass_g, conf.level = 0.95)$conf.int[2])
df_grouped
df$body_mass_kg <- df$body_mass_g/1000
gg <- ggplot(df, aes(x=flipper_length_mm, y=body_mass_kg, color=species)) +
geom_point(size=2)
gg
m <- glm(body_mass_kg ~ flipper_length_mm + bill_length_mm, data=df, family="gaussian")
m
summary(m)
df_grouped$p_values <- coef(summary(m))[,4]
table <- confint(m)
table <- cbind(table, unlist(coef(summary(m))[,4]))
colnames(table) <- c('lower ci', 'upper ci', 'p-value')
table
full <- glm(body_mass_kg ~ flipper_length_mm + bill_length_mm, data=df, family="gaussian")
reduced <- glm(body_mass_kg ~ 1, data=df, family="gaussian")
anova(reduced, full, test="F")
summary(full)
m <- glm(body_mass_kg ~ flipper_length_mm + bill_length_mm, data=df, family="gaussian")
m
#coefficients of model
c <- coefficients(m)
c
c[1]
#get quantiles of bill length
quantile(df$bill_length_mm, na.rm = TRUE)
gg +
geom_line(aes(y=-5.7369 + c[3]*35 + c[2]*flipper_length_mm), color="green") +
geom_line(aes(y=-5.7369 + c[3]*44.45 + c[2]*flipper_length_mm), color="red") +
geom_line(aes(y=-5.7369 + c[3]*48.5 + c[2]*flipper_length_mm), color="blue") +
geom_text(aes(x = 238, y = 5.600, label = "35 mm bill length"), size=2, color="green") +
geom_text(aes(x = 238, y = 5.700, label = "44.45 mm bill length"), size=2, color="red") +
geom_text(aes(x = 238, y = 5.800, label = "48.5 mm bill length"), size=2, color="blue")
full <- glm(body_mass_kg ~ flipper_length_mm + bill_length_mm, data=df, family="gaussian")
reduced <- glm(body_mass_kg ~ 1, data=df, family="gaussian")
anova(reduced, full, test="F")
full <- glm(body_mass_kg ~ flipper_length_mm + bill_length_mm, data=df, family="gaussian")
reduced <- glm(body_mass_kg ~ bill_length_mm, data=df, family="gaussian")
anova(ful, reduced, test="LRT")
full <- glm(body_mass_kg ~ flipper_length_mm + bill_length_mm, data=df, family="gaussian")
reduced <- glm(body_mass_kg ~ bill_length_mm, data=df, family="gaussian")
anova(full, reduced, test="LRT")
```{r}
full <- glm(body_mass_kg ~ flipper_length_mm + bill_length_mm, data=df, family="gaussian")
reduced <- glm(body_mass_kg ~ bill_length_mm, data=df, family="gaussian")
anova(full, reduced, test="F")
full <- glm(body_mass_kg ~ flipper_length_mm + bill_length_mm, data=df, family="gaussian")
reduced <- glm(body_mass_kg ~ flipper_length_mm, data=df, family="gaussian")
anova(full, reduced, test="F")
install.packages('cowplot')
